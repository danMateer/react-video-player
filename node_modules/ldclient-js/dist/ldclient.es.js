function createCustomError(e){function n(e,n){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.message=e,this.code=n}return n.prototype=new Error,n.prototype.name=e,n.prototype.constructor=n,n}var LDUnexpectedResponseError=createCustomError("LaunchDarklyUnexpectedResponseError"),LDInvalidEnvironmentIdError=createCustomError("LaunchDarklyInvalidEnvironmentIdError"),LDInvalidUserError=createCustomError("LaunchDarklyInvalidUserError"),LDInvalidEventKeyError=createCustomError("LaunchDarklyInvalidEventKeyError"),LDInvalidArgumentError=createCustomError("LaunchDarklyInvalidArgumentError"),LDFlagFetchError=createCustomError("LaunchDarklyFlagFetchError");function isHttpErrorRecoverable(e){return!(e>=400&&e<500)||(400===e||408===e||429===e)}function createCommonjsModule(e,n){return e(n={exports:{}},n.exports),n.exports}var base64=createCommonjsModule(function(e,n){!function(){var e=n,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r(e){this.message=e}r.prototype=new Error,r.prototype.name="InvalidCharacterError",e.btoa||(e.btoa=function(e){for(var n,o,a=String(e),i=0,s=t,u="";a.charAt(0|i)||(s="=",i%1);u+=s.charAt(63&n>>8-i%1*8)){if((o=a.charCodeAt(i+=.75))>255)throw new r("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|o}return u}),e.atob||(e.atob=function(e){var n=String(e).replace(/[=]+$/,"");if(n.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,a,i=0,s=0,u="";a=n.charAt(s++);~a&&(o=i%4?64*o+a:a,i++%4)?u+=String.fromCharCode(255&o>>(-2*i&6)):0)a=t.indexOf(a);return u})}()}),_extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};function btoa(e){return base64.btoa(unescape(encodeURIComponent(e)))}function base64URLEncode(e){return btoa(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function clone(e){return JSON.parse(JSON.stringify(e))}function onNextTick(e){setTimeout(e,0)}function wrapPromiseCallback(e,n){var t=e.then(function(e){return n&&setTimeout(function(){n(null,e)},0),e},function(e){if(!n)return Promise.reject(e);setTimeout(function(){n(e,null)},0)});return n?void 0:t}function transformValuesToVersionedValues(e){var n={};for(var t in e)e.hasOwnProperty(t)&&(n[t]={value:e[t],version:0});return n}function transformVersionedValuesToValues(e){var n={};for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t].value);return n}function chunkUserEventsForUrl(e,n){for(var t=n.slice(0),r=[],o=e,a=void 0;t.length>0;){for(a=[];o>0;){var i=t.shift();if(!i)break;(o-=base64URLEncode(JSON.stringify(i)).length)<0&&a.length>0?t.unshift(i):a.push(i)}o=e,r.push(a)}return r}function getLDUserAgentString(){return"JSClient/2.7.0"}function addLDHeaders(e){e.setRequestHeader("X-LaunchDarkly-User-Agent",getLDUserAgentString())}function extend(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.reduce(function(e,n){return _extends({},e,n)},{})}var MAX_URL_LENGTH=2e3;function EventSender(e,n,t,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=void 0,i=e+"/events/bulk/"+n,s=e+"/a/"+n+".gif",u={};function c(e,n){var t=new Image;n&&t.addEventListener("load",n),t.src=e}function l(e,n,t){var a=r||c,u=JSON.stringify(e),l=function(e){if(n)(function n(r){var a=new XMLHttpRequest;return a.open("POST",i,!t),o&&addLDHeaders(a),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("X-LaunchDarkly-Event-Schema","3"),t||(a.addEventListener("load",function(){a.status>=400&&isHttpErrorRecoverable(a.status)&&r?n(!1).send(u):e(function(e){var n={status:e.status},t=e.getResponseHeader("Date");if(t){var r=Date.parse(t);r&&(n.serverTime=r)}return n}(a))}),r&&a.addEventListener("error",function(){n(!1).send(u)})),a})(!0).send(u);else{var r=s+"?d="+base64URLEncode(u);a(r,t?null:e)}};if(!t)return new Promise(function(e){l(e)});l()}return u.sendEvents=function(n,r){void 0===a&&(a=void 0===t?"withCredentials"in new XMLHttpRequest:t);var o=void 0!==r&&r,i=void 0;i=a?[n]:chunkUserEventsForUrl(MAX_URL_LENGTH-e.length,n);for(var s=[],u=0;u<i.length;u++)s.push(l(i[u],a,o));return r?Promise.resolve():Promise.all(s)},u}function EventSummarizer(){var e={},n=0,t=0,r={};return e.summarizeEvent=function(e){if("feature"===e.kind){var o=e.key+":"+(null!==e.variation&&void 0!==e.variation?e.variation:"")+":"+(null!==e.version&&void 0!==e.version?e.version:""),a=r[o];a?a.count=a.count+1:r[o]={count:1,key:e.key,variation:e.variation,version:e.version,value:e.value,default:e.default},(0===n||e.creationDate<n)&&(n=e.creationDate),e.creationDate>t&&(t=e.creationDate)}},e.getSummary=function(){var e={},o=!0;for(var a in r){var i=r[a],s=e[i.key];s||(s={default:i.default,counters:[]},e[i.key]=s);var u={value:i.value,count:i.count};void 0!==i.variation&&null!==i.variation&&(u.variation=i.variation),i.version?u.version=i.version:u.unknown=!0,s.counters.push(u),o=!1}return o?null:{startDate:n,endDate:t,features:e}},e.clearSummary=function(){n=0,t=0,r={}},e}var docLink=" Please see https://docs.launchdarkly.com/docs/js-sdk-reference#section-initializing-the-client for instructions on SDK initialization.",localStorageUnavailable=function(){return"localStorage is unavailable"},unknownCustomEventKey=function(e){return'Custom event "'+e+'" does not exist'},environmentNotFound=function(){return"environment not found."+docLink},environmentNotSpecified=function(){return"No environment specified."+docLink},errorFetchingFlags=function(e){return"Error fetching flag settings: "+(e.message||e)},userNotSpecified=function(){return"No user specified."+docLink},invalidUser=function(){return"Invalid user specified."+docLink},bootstrapOldFormat=function(){return"LaunchDarkly client was initialized with bootstrap data that did not include flag metadata. Events may not be sent correctly."+docLink},bootstrapInvalid=function(){return"LaunchDarkly bootstrap data is not available because the back end could not read the flags."},deprecated=function(e,n){return'[LaunchDarkly] "'+e+'" is deprecated, please use "'+n+'"'},httpErrorMessage=function(e,n,t){return"Received error "+e+(401===e?" (invalid SDK key)":"")+" for "+n+" - "+(errors.isHttpErrorRecoverable(e)?t:"giving up permanently")};function UserFilter(e){var n={},t=void 0!==e.allAttributesPrivate?e.allAttributesPrivate:e.all_attributes_private,r=(void 0!==e.privateAttributeNames?e.privateAttributeNames:e.private_attribute_names)||[],o={key:!0,custom:!0,anonymous:!0},a={key:!0,secondary:!0,ip:!0,country:!0,email:!0,firstName:!0,lastName:!0,avatar:!0,name:!0,anonymous:!0,custom:!0};return void 0!==e.all_attributes_private&&console&&console.warn&&console.warn(deprecated("all_attributes_private","allAttributesPrivate")),void 0!==e.private_attribute_names&&console&&console.warn&&console.warn(deprecated("private_attribute_names","privateAttributeNames")),n.filterUser=function(e){if(!e)return null;var n=e.privateAttributeNames||[],i=function(e,a){return Object.keys(e).reduce(function(i,s){var u=i;return a(s)&&(!function(e){return!o[e]&&(t||-1!==n.indexOf(e)||-1!==r.indexOf(e))}(s)?u[0][s]=e[s]:u[1][s]=!0),u},[{},{}])},s=i(e,function(e){return a[e]}),u=s[0],c=s[1];if(e.custom){var l=i(e.custom,function(){return!0});u.custom=l[0],c=extend({},c,l[1])}var v=Object.keys(c);return v.length&&(v.sort(),u.privateAttrs=v),u},n}function EventProcessor(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments[5],i={},s=o||EventSender(e,n,a),u=EventSummarizer(),c=UserFilter(t),l=!!t.inlineUsersInEvents,v=[],d=void 0,f=void 0,p=0,g=!1,h=void 0;function m(e){onNextTick(function(){r&&r.maybeReportError(new LDInvalidArgumentError(e))})}function y(){return 0===f||0===Math.floor(Math.random()*f)}return void 0!==t.samplingInterval&&(isNaN(t.samplingInterval)||t.samplingInterval<0)?(f=0,m("Invalid sampling interval configured. Sampling interval must be an integer >= 0.")):f=t.samplingInterval||0,void 0!==t.flushInterval&&(isNan(t.flushInterval)||t.flushInterval<2e3)?(d=2e3,m("Invalid flush interval configured. Must be an integer >= 2000 (milliseconds).")):d=t.flushInterval||2e3,i.enqueue=function(e){if(!g){var n,t=!1,r=!1;if(u.summarizeEvent(e),"feature"===e.kind?y()&&(t=!!e.trackEvents,r=!!(n=e).debugEventsUntilDate&&n.debugEventsUntilDate>p&&n.debugEventsUntilDate>(new Date).getTime()):t=y(),t&&v.push(function(e){var n=extend({},e);return l||"identify"===e.kind?n.user=c.filterUser(e.user):(n.userKey=e.user.key,delete n.user),"feature"===e.kind&&(delete n.trackEvents,delete n.debugEventsUntilDate),n}(e)),r){var o=extend({},e,{kind:"debug"});delete o.trackEvents,delete o.debugEventsUntilDate,delete o.variation,v.push(o)}}},i.flush=function(e){if(g)return Promise.resolve();var n=v,t=u.getSummary();return u.clearSummary(),t&&(t.kind="summary",n.push(t)),0===n.length?Promise.resolve():(v=[],s.sendEvents(n,e).then(function(e){e&&(e.serverTime&&(p=e.serverTime),isHttpErrorRecoverable(e.status)||(g=!0),e.status>=400&&onNextTick(function(){r.maybeReportError(new LDUnexpectedResponseError(httpErrorMessage(e.status,"event posting","some events were dropped")))}))}))},i.start=function(){h=setTimeout(function e(){i.flush(),h=setTimeout(e,d)},d)},i.stop=function(){clearTimeout(h)},i}function EventEmitter(){var e={},n={};return e.on=function(e,t,r){n[e]=n[e]||[],n[e]=n[e].concat({handler:t,context:r})},e.off=function(e,t,r){if(n[e])for(var o=0;o<n[e].length;o++)n[e][o].handler===t&&n[e][o].context===r&&(n[e]=n[e].slice(0,o).concat(n[e].slice(o+1)))},e.emit=function(e){if(n[e])for(var t=0;t<n[e].length;t++)n[e][t].handler.apply(n[e][t].context,Array.prototype.slice.call(arguments,1))},e.maybeReportError=function(e){e&&(n["error"]?this.emit("error",e):console.error(e.message))},e}var matchOperatorsRe=/[|\\{}()[\]^$+*?.]/g,escapeStringRegexp=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(matchOperatorsRe,"\\$&")};function doesUrlMatch(e,n,t,r){var o=n.replace(t,"").replace(r,""),a=void 0,i=void 0;switch(e.kind){case"exact":i=n,a=new RegExp("^"+escapeStringRegexp(e.url)+"/?$");break;case"canonical":i=o,a=new RegExp("^"+escapeStringRegexp(e.url)+"/?$");break;case"substring":i=o,a=new RegExp(".*"+escapeStringRegexp(e.substring)+".*$");break;case"regex":i=o,a=new RegExp(e.pattern);break;default:return!1}return a.test(i)}function findGoalsForClick(e,n){for(var t=[],r=0;r<n.length;r++)for(var o=e.target,a=n[r],i=a.selector,s=document.querySelectorAll(i);o&&s.length>0;){for(var u=0;u<s.length;u++)o===s[u]&&t.push(a);o=o.parentNode}return t}function GoalTracker(e,n){for(var t={},r=null,o=[],a=0;a<e.length;a++)for(var i=e[a],s=i.urls||[],u=0;u<s.length;u++)if(doesUrlMatch(s[u],location.href,location.search,location.hash)){"pageview"===i.kind?n("pageview",i):(o.push(i),n("click_pageview",i));break}return o.length>0&&(r=function(e){for(var t=findGoalsForClick(e,o),r=0;r<t.length;r++)n("click",t[r])},document.addEventListener("click",r)),t.dispose=function(){document.removeEventListener("click",r)},t}function Store(e,n,t){var r={};function o(){var r="",o=t.getUser();return o&&(r=n||btoa(JSON.stringify(o))),"ld:"+e+":"+r}return r.loadFlags=function(){var e=o(),n=void 0,t=void 0;try{n=localStorage.getItem(e)}catch(e){return console.warn(localStorageUnavailable()),null}try{t=JSON.parse(n)}catch(e){return r.clearFlags(),null}if(t){var a=t.$schema;(void 0===a||a<1)&&(t=transformValuesToVersionedValues(t))}return t},r.saveFlags=function(e){var n=o(),t=extend({},e,{$schema:1});try{localStorage.setItem(n,JSON.stringify(t))}catch(e){console.warn(localStorageUnavailable())}},r.clearFlags=function(){var e=o();try{localStorage.removeItem(e)}catch(e){}},r}function Stream(e,n,t,r){var o={},a=e+"/eval/"+n+"/",i=r&&r.useReport||!1,s=r&&r.evaluationReasons||!1,u=r&&r.streamReconnectDelay||1e3,c=null,l=null,v=null,d=null;function f(){h(),p(u)}function p(e){l||(e?l=setTimeout(g,e):g())}function g(){var r=void 0,o="";if("undefined"!=typeof EventSource){for(var u in i?r=e+"/ping/"+n:(r=a+base64URLEncode(JSON.stringify(v)),null!=t&&(o="h="+t)),s&&(o=o+(o?"&":"")+"withReasons=true"),r=r+(o?"?":"")+o,h(),c=new window.EventSource(r),d)d.hasOwnProperty(u)&&c.addEventListener(u,d[u]);c.onerror=f}}function h(){c&&(c.close(),c=null)}return o.connect=function(e,n){v=e,d=n,p()},o.disconnect=function(){clearTimeout(l),l=null,close()},o.isConnected=function(){return c&&(c.readyState===EventSource.OPEN||c.readyState===EventSource.CONNECTING)},o}var json="application/json";function fetchJSON(e,n,t,r){var o=new XMLHttpRequest,a=void 0;return o.addEventListener("load",function(){200===o.status&&o.getResponseHeader("Content-type")&&0===o.getResponseHeader("Content-Type").lastIndexOf(json)?t(null,JSON.parse(o.responseText)):t(getResponseError(o))}),o.addEventListener("error",function(){t(getResponseError(o))}),n?(o.open("REPORT",e),o.setRequestHeader("Content-Type","application/json"),a=JSON.stringify(n)):o.open("GET",e),r&&addLDHeaders(o),o.send(a),o}function getResponseError(e){return 404===e.status?new LDInvalidEnvironmentIdError(environmentNotFound()):e.statusText}function Requestor(e,n,t,r,o){var a=void 0,i=void 0,s={fetchFlagSettings:function(s,u,c){var l=void 0,v=void 0,d="",f=void 0,p=void 0;t?(v=[e,"/sdk/evalx/",n,"/user"].join(""),f=s):(l=base64URLEncode(JSON.stringify(s)),v=[e,"/sdk/evalx/",n,"/users/",l].join("")),u&&(d="h="+u),r&&(d=d+(d?"&":"")+"withReasons=true"),v=v+(d?"?":"")+d;var g,h,m=(g=c,function(e,n){g(e,n),a=null,i=null});a?(a.abort(),h=i,p=function(){h&&h.apply(null,arguments),m.apply(null,arguments)}):p=m,i=p,a=fetchJSON(v,f,p,o)},fetchGoals:function(t){fetchJSON([e,"/sdk/goals/",n].join(""),null,t,o)}};return s}function sanitizeUser(e){var n=clone(e);return n.key&&(n.key=n.key.toString()),n}function Identity(e,n){var t={},r=void 0;return t.setUser=function(e){r=sanitizeUser(e),n(clone(r))},t.getUser=function(){return r?clone(r):null},e&&t.setUser(e),t}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},readyEvent="ready",successEvent="initialized",failedEvent="failed",changeEvent="change",goalsEvent="goalsReady",locationWatcherInterval=300;function initialize(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.baseUrl||"https://app.launchdarkly.com",o=t.eventsUrl||"https://events.launchdarkly.com",a=t.streamUrl||"https://clientstream.launchdarkly.com",i=t.hash,s=L("sendEvents",!0),u=L("sendLDHeaders",!0),c=!!t.allowFrequentDuplicateEvents,l=!!t.sendEventsOnlyForVariation,v=void 0===t.fetchGoals||t.fetchGoals,d=e,f=EventEmitter(),p=Stream(a,d,i,t),g=t.eventProcessor||EventProcessor(o,d,t,f,null,u),h=Requestor(r,d,t.useReport,t.evaluationReasons,u),m={},y="object"===_typeof(t.bootstrap)?function(e){var n=Object.keys(e),t=e.$flagsState;!t&&n.length&&console.warn(bootstrapOldFormat());!1===e.$valid&&console.warn(bootstrapInvalid());var r={};return n.forEach(function(n){if("$flagsState"!==n&&"$valid"!==n){var o={value:e[n]};t&&t[n]?o=extend(o,t[n]):o.version=0,r[n]=o}}),r}(t.bootstrap):{},E=void 0,k=void 0,b=void 0,w=void 0,S=!0;function L(e,n){return void 0===t[e]?n:t[e]}function D(){return s&&!function(){var e=void 0;e=navigator&&void 0!==navigator.doNotTrack?navigator.doNotTrack:navigator&&void 0!==navigator.msDoNotTrack?navigator.msDoNotTrack:window.doNotTrack;return"1"===e||"yes"===e}()}function R(e){e.user?(S=!1,D()&&g.enqueue(e)):S&&(console&&console.warn&&console.warn("Be sure to call `identify` in the LaunchDarkly client: http://docs.launchdarkly.com/docs/running-an-ab-test#include-the-client-side-snippet"),S=!1)}var U=Identity(n,function(e){e&&R({kind:"identify",key:e.key,user:e,creationDate:(new Date).getTime()})}),N=Store(d,i,U);function x(e,n,t){var r=U.getUser(),o=new Date,a=n?n.value:null;if(!c){var i=JSON.stringify(a)+(r&&r.key?r.key:"")+e,s=m[i];if(s&&o-s<3e5)return;m[i]=o}var u={kind:"feature",key:e,user:r,value:a,variation:n?n.variationIndex:null,default:t,creationDate:o.getTime(),reason:n?n.reason:null},l=y[e];l&&(u.version=l.flagVersion?l.flagVersion:l.version,u.trackEvents=l.trackEvents,u.debugEventsUntilDate=l.debugEventsUntilDate),R(u)}function F(e,n){var t={kind:e,key:n.key,data:null,url:window.location.href,user:U.getUser(),creationDate:(new Date).getTime()};return"click"===e&&(t.selector=n.selector),R(t)}function T(e,n,t){var r=void 0;if(y&&y.hasOwnProperty(e)&&y[e]&&!y[e].deleted){var o=y[e];r=I(o),null!==o.value&&void 0!==o.value||(r.value=n)}else r={value:n,variationIndex:null,reason:{kind:"ERROR",errorKind:"FLAG_NOT_FOUND"}};return t&&x(e,r,n),r}function I(e){return{value:e.value,variationIndex:void 0===e.variation?null:e.variation,reason:e.reason||null}}function O(){U.getUser()&&p.connect(U.getUser(),{ping:function(){h.fetchFlagSettings(U.getUser(),i,function(e,n){e&&f.maybeReportError(new LDFlagFetchError(errorFetchingFlags(e))),C(n)})},put:function(e){C(JSON.parse(e.data))},patch:function(e){var n=JSON.parse(e.data),t=y[n.key];if(!t||!t.version||!n.version||t.version<n.version){var r={},o=extend({},n);delete o.key,y[n.key]=o;var a=I(o);r[n.key]=t?{previous:t.value,current:a}:{current:a},P(r)}},delete:function(e){var n=JSON.parse(e.data);if(!y[n.key]||y[n.key].version<n.version){var t={};y[n.key]&&!y[n.key].deleted&&(t[n.key]={previous:y[n.key].value}),y[n.key]={version:n.version,deleted:!0},P(t)}}})}function C(e){var n={};if(e){for(var t in y)y.hasOwnProperty(t)&&y[t]&&(e[t]&&e[t].value!==y[t].value?n[t]={previous:y[t].value,current:I(e[t])}:e[t]&&!e[t].deleted||(n[t]={previous:y[t].value}));for(var r in e)e.hasOwnProperty(r)&&e[r]&&(!y[r]||y[r].deleted)&&(n[r]={current:I(e[r])});y=e,P(n)}}function P(e){var n=Object.keys(e);if(k&&N.saveFlags(y),n.length>0){var t={};n.forEach(function(n){var r=e[n].current,o=r?r.value:void 0,a=e[n].previous;f.emit(changeEvent+":"+n,o,a),t[n]=r?{current:o,previous:a}:{previous:a}}),f.emit(changeEvent,t),l||n.forEach(function(n){x(n,e[n].current)})}}function A(){E&&E.dispose(),b&&b.length&&(E=GoalTracker(b,F))}function _(){f.emit(readyEvent),f.emit(successEvent)}function j(e){f.maybeReportError(e),f.emit(failedEvent,e),f.emit(readyEvent)}function H(){s&&g.start()}e||onNextTick(function(){f.maybeReportError(new LDInvalidEnvironmentIdError(environmentNotSpecified()))}),n?n.key||onNextTick(function(){f.maybeReportError(new LDInvalidUserError(invalidUser()))}):onNextTick(function(){f.maybeReportError(new LDInvalidUserError(userNotSpecified()))}),"object"===_typeof(t.bootstrap)?onNextTick(_):"string"==typeof t.bootstrap&&"LOCALSTORAGE"===t.bootstrap.toUpperCase()&&localStorage?(k=!0,null===(y=N.loadFlags())?(y={},h.fetchFlagSettings(U.getUser(),i,function(e,n){e?j(new LDFlagFetchError(errorFetchingFlags(e))):(n?(y=n,N.saveFlags(y)):y={},_())})):(onNextTick(_),h.fetchFlagSettings(U.getUser(),i,function(e,n){e&&f.maybeReportError(new LDFlagFetchError(errorFetchingFlags(e))),n&&N.saveFlags(n)}))):h.fetchFlagSettings(U.getUser(),i,function(e,n){e?(y={},j(new LDFlagFetchError(errorFetchingFlags(e)))):(y=n||{},_())}),v&&h.fetchGoals(function(e,n){e&&f.maybeReportError(new LDUnexpectedResponseError((e.message,e.message))),n&&n.length>0&&(E=GoalTracker(b=n,F),function(e,n){var t=location.href,r=void 0;function o(){(r=location.href)!==t&&(t=r,n())}!function e(n,t){n(),setTimeout(function(){e(n,t)},t)}(o,e),window.history&&history.pushState?window.addEventListener("popstate",o):window.addEventListener("hashchange",o)}(locationWatcherInterval,A)),f.emit(goalsEvent)}),"complete"!==document.readyState?window.addEventListener("load",H):H(),window.addEventListener("beforeunload",function(){s&&(g.stop(),g.flush(!0))}),window.addEventListener("message",function(e){if(e.origin===r&&"SYN"===e.data.type){window.editorClientBaseUrl=r;var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=r+e.data.editorClientUrl;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(n,t)}});var J=new Promise(function(e){var n=f.on(readyEvent,function(){f.off(readyEvent,n),e()})}),z=new Promise(function(e){var n=f.on(goalsEvent,function(){f.off(goalsEvent,n),e()})}),G=new Promise(function(e,n){var t=f.on(successEvent,function(){f.off(successEvent,t),e()}),r=f.on(failedEvent,function(e){f.off(failedEvent,r),n(e)})});return{waitForInitialization:function(){return G},waitUntilReady:function(){return J},waitUntilGoalsReady:function(){return z},identify:function(e,n,t){return k&&N.clearFlags(),wrapPromiseCallback(new Promise(function(t,r){if(e&&null!==e.key&&void 0!==e.key)U.setUser(e),h.fetchFlagSettings(U.getUser(),n,function(e,n){if(e)return f.maybeReportError(new LDFlagFetchError(errorFetchingFlags(e))),r(e);n&&C(n),t(transformVersionedValuesToValues(n)),w&&O()});else{var o=new LDInvalidUserError(e?invalidUser():userNotSpecified());f.maybeReportError(o),r(o)}}),t)},variation:function(e,n){return T(e,n,!0).value},variationDetail:function(e,n){return T(e,n,!0)},track:function(e,n){"string"==typeof e?(b&&!function(e){if(!b||0===b.length)return!1;for(var n=0;n<b.length;n++)if("custom"===b[n].kind&&b[n].key===e)return!0;return!1}(e)&&console.warn(unknownCustomEventKey(e)),R({kind:"custom",key:e,data:n,user:U.getUser(),url:window.location.href,creationDate:(new Date).getTime()})):f.maybeReportError(new LDInvalidEventKeyError(unknownCustomEventKey(e)))},on:function(e,n,t){e.substr(0,changeEvent.length)===changeEvent?(w=!0,p.isConnected()||O(),f.on.apply(f,[e,n,t])):f.on.apply(f,Array.prototype.slice.call(arguments))},off:function(e){e===changeEvent&&(w=!0)&&(w=!1,p.disconnect()),f.off.apply(f,Array.prototype.slice.call(arguments))},flush:function(e){return wrapPromiseCallback(new Promise(function(e){return s?e(g.flush()):e()},e))},allFlags:function(){var e={};if(!y)return e;for(var n in y)y.hasOwnProperty(n)&&(e[n]=T(n,null,!l).value);return e}}}var version="2.7.0";function deprecatedInitialize(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return console&&console.warn&&console.warn(deprecated("default export","named LDClient export")),initialize(e,n,t)}var index={initialize:deprecatedInitialize,version:version};export default index;export{initialize,version};
//# sourceMappingURL=ldclient.es.js.map
